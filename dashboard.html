<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

<div class="header">
    Admin Dashboard – Complaints
    <a href="/logout" style="float:right;">
        <button>Logout</button>
    </a>
</div>

<!-- FILTER SECTION -->
<div style="width:90%; margin:20px auto;">
    <form method="GET" action="/admin">
        <label><strong>Status:</strong></label>
        <select name="status">
            <option value="all">All</option>
            <option value="Pending">Pending</option>
            <option value="Resolved">Resolved</option>
        </select>

        &nbsp;&nbsp;

        <label><strong>Student Name:</strong></label>
        <input type="text" name="search" placeholder="Enter name">

        <button type="submit">Apply</button>
    </form>
</div>

<!-- SUMMARY CARDS -->
<div style="width:90%; margin:20px auto; display:flex; gap:20px;">
    <div style="flex:1; background:white; padding:20px; border-radius:8px; text-align:center;">
        <h4>Total</h4>
        <h2 style="color:#4f46e5;">{{ total_count }}</h2>
    </div>

    <div style="flex:1; background:white; padding:20px; border-radius:8px; text-align:center;">
        <h4>Pending</h4>
        <h2 style="color:orange;">{{ pending_count }}</h2>
    </div>

    <div style="flex:1; background:white; padding:20px; border-radius:8px; text-align:center;">
        <h4>Resolved</h4>
        <h2 style="color:green;">{{ resolved_count }}</h2>
    </div>
</div>

<!-- TABLE -->
<div class="table-container" 
     style="width:95%; margin:20px auto; max-height:500px; overflow-y:auto;">
    <table>
        <tr>
            <th>ID</th>
            <th>Student</th>
            <th>Email</th>
            <th>Type</th>
            <th>Description</th>
            <th>Status</th>
            <th>Action</th>
        </tr>

        {% for complaint in complaints %}
        <tr>
            <td>{{ complaint[0] }}</td>
            <td>{{ complaint[1] }}</td>
            <td>{{ complaint[2] }}</td>
            <td>{{ complaint[3] }}</td>
            <td>{{ complaint[4] }}</td>

            <td>
                {% if complaint[5] == 'Pending' %}
                    <span style="color:orange; font-weight:bold;">Pending</span>
                {% else %}
                    <span style="color:green; font-weight:bold;">Resolved</span>
                {% endif %}
            </td>

            <td>
                {% if complaint[5] == 'Pending' %}
                <form method="POST" action="/resolve/{{ complaint[0] }}">
                    <button style="background:#28a745; color:white; border:none; padding:6px 12px; border-radius:5px;">
                        Resolve
                    </button>
                </form>
                {% else %}
                    —
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
</div>

</body>
</html>